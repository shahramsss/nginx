d1 r1 r2
session_01

install nginx
sudo systemctl status nginx.service
sudo  systemctl start nginx.service 
sudo systemctl enable nginx.service
directve
contex = block or section

------------------------------------------------------------
d1 r1 r2
session_02

modules

http

http core modules
nginx -h = help 
sudo nginx -t = test config files
events {} = use events contex is forced
sudo  systemctl restart nginx.service 
sudo  systemctl reload nginx.service 

sample code:
-----------------
# main context

events {}

http {
        server {
                server_name 127.0.0.1;
                listen 81;
                return 200 "hello";
        }
        server { 
                server_name 127.0.0.2;
                listen 81;
                return 200 "hello 127002 this is new page";
        }
}

------------------------------------------------------------
d1 r1 r2
section_03

user 
root
Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø®Øµ Ú©Ø±Ø¯Ù† Ù…Ø³ÛŒØ± Ø±ÛŒØ´Ù‡ Ø¯Ø§ÛŒØ±Ú©ØªÙˆØ±ÛŒ Ø¯Ø± ÙØ§ÛŒÙ„â€Œ Ø³ÛŒØ³ØªÙ… Ø³Ø±ÙˆØ± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ú©Ù‡ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªØ§ØªÛŒÚ© (Ù…Ø«Ù„ HTMLØŒ CSSØŒ ØªØµØ§ÙˆÛŒØ± Ùˆ...) Ø§Ø² Ø¢Ù†Ø¬Ø§ Ø³Ø±Ùˆ Ø´ÙˆÙ†Ø¯.

index
location 
ÙˆÙ‚ØªÛŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øª HTTP Ø¨Ù‡ ÛŒÚ© Ù…Ø³ÛŒØ± ÛŒØ§ Ø§Ù„Ú¯ÙˆÛŒ Ø®Ø§Øµ Ø±Ø³ÛŒØ¯ØŒ Nginx Ú†Ø·ÙˆØ± Ø¨Ø§ÛŒØ¯ Ø¢Ù† Ø±Ø§ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù†Ø¯

location url { 
    configurations ...
}

contex: server , location

root path

/var/log/nginx/error.log

http://127.0.0.1:81/blog.html

location /somepath/ {
    root /var/www/html;
}
http://example.com/somepath/image.jpg
/var/www/html/somepath/image.jpg


    location / {
        # ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ù‡â€ŒÛŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§
    }

    location /images/ {
        # Ø¨Ø±Ø§ÛŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§ÛŒÛŒ Ú©Ù‡ Ø¨Ø§ /images/ Ø´Ø±ÙˆØ¹ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
    }

    location = /about {
        # ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ /about Ø¯Ù‚ÛŒÙ‚Ø§Ù‹
    }

    location ~ \.php$ {
        # Ø¨Ø±Ø§ÛŒ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒÛŒ Ú©Ù‡ Ù¾Ø³ÙˆÙ†Ø¯ .php Ø¯Ø§Ø±Ù†Ø¯ (regex)
    }

    location ~* \.(jpg|jpeg|png|gif|ico)$ {
        # Ø¨Ø¯ÙˆÙ† Ø­Ø³Ø§Ø³ÛŒØª Ø¨Ù‡ Ø­Ø±ÙˆÙ Ø¨Ø²Ø±Ú¯/Ú©ÙˆÚ†Ú© (jpg/JPG Ùˆ ...)
    }

sample code:
-----------------
user sss;

events {}

http {
        server {
                server_name 127.0.0.1;
                listen 81;
                root /home/sss/Desktop/nginx/blog;
                index blog.html;

                location /docs {
                        index doc.html;
                }
        }       
}

------------------------------------------------------------
d1 r1 r2  
session_04

logging
access log
error log 

Syntax:	error_log file [level];
Default: error_log logs/error.log error;
Context: main, http, mail, stream, server, location

/var/log/nginx/

change format
Alphabetical index of variable

Syntax:	log_format name [escape=default|json|none] string ...;
Default: log_format combined "...";
Context: http

sample code:
-----------------
user sss;

error_log /var/log/nginx/error.log warn;

events {}

http {

        log_format main '$remote_addr $remote_user $time_local $request '
                        '$status $body_byte_sent $http_user_agent';
        server {
                server_name 127.0.0.1;
                listen 81;
                root /home/sss/Desktop/nginx/blog;
                index blog.html;

                access_log /var/log/nginx/access.log main;

                location /docs {
                        index doc.html;
                        error_log /var/log/nginx/error_docs.log warn;
                        access_log /var/log/nginx/access_docs.log main;
                }
        }       
}
------------------------------------------------------------
d2 r1 r2
session_05

error pages

Syntax:	error_page code ... [=[response]] uri;
Default:	â€”
Context:	http, server, location, if in location

error_page 404             /404.html;
error_page 500 502 503 504 /50x.html;

Syntax:	internal;
Default:	â€”
Context:	location


sample code:
-----------------
# main context
user sss;

error_log /var/log/nginx/error.log;

events {}

http {
	server {
		server_name 127.0.0.1;
		listen 81;
		root /home/sss/Desktop/nginx/blog;
		index blog.html;

		error_page 404 =200 /404.html;

		access_log /var/log/nginx/access.log;
			
		location /docs {
			index doc.html;
			error_log /var/log/nginx/error_docs.log;
			access_log /var/log/nginx/access_docs.log;
		}

		location /404.html {
			root /home/sss/Desktop/nginx/blog/errors;
			internal;

		}
	}	
}
------------------------------------------------------------
d2 r1 r2
session_06

Syntax:	worker_processes number | auto;
Default:	worker_processes 1;
Context:	main
Ú†Ù‡ ØªØ¹Ø¯Ø§Ø¯ ÙØ±Ø¢ÛŒÙ†Ø¯ worker Ø¨Ø§ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ø´ÙˆÙ†Ø¯.

Syntax:	autoindex on | off;
Default:	
autoindex off;
Context:	http, server, location
ÙˆÙ‚ØªÛŒ ÛŒÚ© Ù¾ÙˆØ´Ù‡ (Ø¯Ø§ÛŒØ±Ú©ØªÙˆØ±ÛŒ) Ø¨Ø¯ÙˆÙ† ÙØ§ÛŒÙ„ index (Ù…Ø«Ù„ index.html) Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù…ÛŒâ€ŒØ´ÙˆØ¯ØŒ Ù„ÛŒØ³Øª ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ø¯Ø± Ø¢Ù† Ø¯Ø§ÛŒØ±Ú©ØªÙˆØ±ÛŒ Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø± Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø´ÙˆØ¯ ÛŒØ§ Ù†Ù‡.

index NO_EXISTENT_INDEX;
ÛŒÙ† Ø¯Ø³ØªÙˆØ± Ø¨Ù‡ Nginx Ù…ÛŒâ€ŒÚ¯ÙˆÛŒØ¯ ÙÙ‚Ø· Ø¨Ù‡ Ø¯Ù†Ø¨Ø§Ù„ ÙØ§ÛŒÙ„ÛŒ Ø¨Ù‡ Ù†Ø§Ù… NO_EXISTENT_INDEX Ø¨Ú¯Ø±Ø¯.
Ú†ÙˆÙ† Ø§ÛŒÙ† ÙØ§ÛŒÙ„ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯ (Ù†Ø§Ù…Ø´ Ù‡Ù… Ù…Ø´Ø®ØµØ§Ù‹ Ø§ÛŒÙ† Ø±Ø§ Ù†Ø´Ø§Ù† Ù…ÛŒâ€ŒØ¯Ù‡Ø¯)ØŒ Nginx Ù‡ÛŒÚ† ÙØ§ÛŒÙ„ index Ù¾ÛŒØ¯Ø§ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.
Ø¯Ø± Ù†ØªÛŒØ¬Ù‡:
    Ø§Ú¯Ø± autoindex on; Ø¨Ø§Ø´Ø¯ â†’ Ù„ÛŒØ³Øª ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¯Ø§ÛŒØ±Ú©ØªÙˆØ±ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.
    Ø§Ú¯Ø± autoindex off; Ø¨Ø§Ø´Ø¯ â†’ Ø®Ø·Ø§ÛŒ 403 Forbidden ÛŒØ§ 404 Not Found Ø¨Ø±Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø¯ (Ø¨Ø³ØªÙ‡ Ø¨Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¯ÛŒÚ¯Ø±).

Syntax:	include file | mask;
Default:	â€”
Context:	any
 Ø¨Ø±Ø§ÛŒ ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù† ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ Ø¯ÛŒÚ¯Ø± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.
 mime.types: ÙØ§ÛŒÙ„ Ø­Ø§ÙˆÛŒ Ù†ÙˆØ¹â€ŒÙ‡Ø§ÛŒ MIME Ú©Ù‡ Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ø¯Ø±Ø³Øª ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ Ù…Ø«Ù„ PDFØŒ MP3ØŒ PNG Ùˆ ØºÛŒØ±Ù‡ Ø¨Ù‡ Ú©Ø§Ø± Ù…ÛŒâ€ŒØ±ÙˆØ¯.

cat /etc/nginx/mime.types
include mime.types;
include vhosts/*.conf;

Syntax:	default_type mime-type;
Default:	
default_type text/plain;
Context:	http, server, location
 Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø®Øµ Ú©Ø±Ø¯Ù† Ù†ÙˆØ¹ MIME Ù¾ÛŒØ´â€ŒÙØ±Ø¶ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ØŒ Ø¯Ø± ØµÙˆØ±ØªÛŒ Ú©Ù‡ Ù†ÙˆØ¹ ÙØ§ÛŒÙ„ Ø¨Ù‡â€ŒØ·ÙˆØ± Ù…Ø´Ø®Øµ Ù‚Ø§Ø¨Ù„ ØªØ´Ø®ÛŒØµ Ù†Ø¨Ø§Ø´Ø¯.
 
nginx -s <SIGNAL>
where <SIGNAL> can be one of the following:

quit â€“ Shut down gracefully (the SIGQUIT signal)
reload â€“ Reload the configuration file (the SIGHUP signal)
reopen â€“ Reopen log files (the SIGUSR1 signal)
stop â€“ Shut down immediately (or fast shutdown, the SIGTERM signal)


sample code:
-----------------
user sss;

error_log /var/log/nginx/error.log;

events {}

worker_processes auto;

http {
	server {
		server_name 127.0.0.1;
		listen 81;
		root /home/sss/Desktop/nginx/blog;

		error_page 404 =200 /404.html;

		access_log /var/log/nginx/access.log;

		autoindex on;
		index NO_EXSTENT_INDEX;

		include /etc/nginx/mime.types;
		default_type text/plain;
			
		location /docs {
			index doc.html;
			error_log /var/log/nginx/error_docs.log;
			access_log /var/log/nginx/access_docs.log;
		}
		location /404.html {
			root /home/sss/Desktop/nginx/blog/errors;
			internal;

		}
	}	
}

------------------------------------------------------------
d2 r1 r2
section_07

reverse proxy

Module ngx_http_proxy_module

Syntax:	proxy_pass URL;
Default:	â€”
Context:	location, if in location, limit_except
 Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§ Ø¨Ù‡ ÛŒÚ© Ø³Ø±ÙˆØ± Ø¯ÛŒÚ¯Ø± (upstream) Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯

 Ø¨Ø§ Ø§Ø³Ù„Ø´ / Ø¯Ø± Ø§Ù†ØªÙ‡Ø§ÛŒ Ù…Ø³ÛŒØ± proxy_pass:
 location /api/ {
    proxy_pass http://localhost:8000/;
}
ÙˆØ±ÙˆØ¯ÛŒ: /api/user/1
Ø®Ø±ÙˆØ¬ÛŒ: Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ø¨Ù‡ â†’ /user/1
ğŸ”„ ÛŒØ¹Ù†ÛŒ /api/ Ø§Ø² Ù…Ø³ÛŒØ± Ø­Ø°Ù Ù…ÛŒâ€ŒØ´ÙˆØ¯.

 Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù„Ø´ Ø¯Ø± Ø§Ù†ØªÙ‡Ø§:
 location /api/ {
    proxy_pass http://localhost:8000;
}
ÙˆØ±ÙˆØ¯ÛŒ: /api/user/1
Ø®Ø±ÙˆØ¬ÛŒ: Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ø¨Ù‡ â†’ /api/user/1
ğŸ”„ ÛŒØ¹Ù†ÛŒ Ù…Ø³ÛŒØ± Ø¨Ù‡ ØµÙˆØ±Øª Ú©Ø§Ù…Ù„ Ø­ÙØ¸ Ù…ÛŒâ€ŒØ´ÙˆØ¯.

Syntax:	proxy_set_header field value;
Default: proxy_set_header Host $proxy_host;
         proxy_set_header Connection close;
Context:	http, server, location
Ø¨Ø±Ø§ÛŒ ØªÙ†Ø¸ÛŒÙ… ÛŒØ§ Ø¨Ø§Ø²Ù†ÙˆÛŒØ³ÛŒ Ù‡Ø¯Ø±Ù‡Ø§ÛŒ HTTP Ù‡Ù†Ú¯Ø§Ù… Ø§Ø±Ø³Ø§Ù„ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ù‡ Ø³Ø±ÙˆØ± Ù…Ù‚ØµØ¯ (upstream) Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.

Ù…Ø§Ú˜ÙˆÙ„ ngx_http_proxy_module Ø§Ù…Ú©Ø§Ù† Ø§Ø±Ø³Ø§Ù„ Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§ Ø¨Ù‡ Ø³Ø±ÙˆØ± Ø¯ÛŒÚ¯Ø± Ø±Ø§ ÙØ±Ø§Ù‡Ù… Ù…ÛŒâ€ŒÚ©Ù†Ø¯.
proxy_set_header Host $host;
proxy_set_header X-Real-IP $remote_addr;

Ø§Ú¯Ø± Ù…Ù‚Ø¯Ø§Ø± ÙÛŒÙ„Ø¯ Ù‡Ø¯Ø± ÛŒÚ© Ø±Ø´ØªÙ‡ Ø®Ø§Ù„ÛŒ Ø¨Ø§Ø´Ø¯ØŒ Ø§ÛŒÙ† ÙÛŒÙ„Ø¯ Ø¨Ù‡ Ø³Ø±ÙˆØ± Ù¾Ø±ÙˆÚ©Ø³ÛŒ Ø§Ø±Ø³Ø§Ù„ Ù†Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯
proxy_set_header Accept-Encoding "";

server_name: Ø¨Ø±Ø§ÛŒ ØªØ´Ø®ÛŒØµ Ø¯Ø§Ù…Ù†Ù‡ Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ Ø¨Ù„Ø§Ú© server
proxy_pass: Ø¨Ø±Ø§ÛŒ ÙØ±Ø³ØªØ§Ø¯Ù† Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ù‡ Ø¬Ø§ÛŒ Ø¯ÛŒÚ¯Ù‡ (upstream)

sample code:
-----------------
# main context
user sss;
events {}
http {
	server {
		server_name 127.0.0.1;
		listen 81;
		
		location / {
			proxy_set_header Host $host;
			proxy_set_header X-Real-IP $remote_addr;
			proxy_set_header Accept-Encoding "";
			proxy_pass http://127.0.0.1:82;
		}
	}	
	
	server {
		server_name 127.0.0.1;
		listen 82;
		
		location / {
			root /home/sss/Desktop/nginx/blog/one;
			index one.html;
		}
	}	
}

------------------------------------------------------------
d2 r1 r2
section_08

load balancer
Module ngx_http_upstream_module

Syntax:	upstream name { ... }
Default:	â€”
Context:	http
 Ø¨Ø±Ø§ÛŒ ØªØ¹Ø±ÛŒÙ ÛŒÚ© Ú¯Ø±ÙˆÙ‡ Ø§Ø² Ø³Ø±ÙˆØ±Ù‡Ø§ÛŒ backend (Ø¨Ú©â€ŒØ§Ù†Ø¯) Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ú©Ù‡ Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§ Ø¨Ù‡ Ø¢Ù†â€ŒÙ‡Ø§ Ù¾Ø±Ø§Ú©Ø³ÛŒ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯

Round Robin 
Least Connections 
IP Hash 
Hash 
Least Time 
Random 

backup
down

helth check
max_fials=<n> fail_timeout=<n>s
Ø¨Ù‡ Ø§ÛŒÙ† Ù…Ø¹Ù†Ø§Ø³Øª Ú©Ù‡ Nginx Ø¨ØªÙˆØ§Ù†Ø¯ ØªØ´Ø®ÛŒØµ Ø¯Ù‡Ø¯ Ú©Ø¯Ø§Ù… Ø³Ø±ÙˆØ±Ù‡Ø§ÛŒ upstream (Ø³Ø±ÙˆØ±Ù‡Ø§ÛŒ Ø¨Ú©â€ŒØ§Ù†Ø¯) Ø³Ø§Ù„Ù… Ù‡Ø³ØªÙ†Ø¯ Ùˆ ÙÙ‚Ø· Ø¨Ù‡ Ø¢Ù†â€ŒÙ‡Ø§ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨ÙØ±Ø³ØªØ¯.
server 127.0.0.1:8000 max_fails=3 fail_timeout=30s;

sample code:
-----------------
# main context
user sss;
events {}
http {
	upstream backends {
		least_conn;
		# ip_hash;
		server 127.0.0.1:82 weight=1;
		# server 127.0.0.1:83 weight=3 down;
		server 127.0.0.1:83 weight=3 down;
		# server 127.0.0.1:84 weight=2;
		server 127.0.0.1:84 backup;
	}

	server {
		server_name 127.0.0.1;
		listen 81;
		location / {
			proxy_pass http://backends;
		}
	}	

	server {
		server_name 127.0.0.1;
		listen 82;
		root /home/sss/Desktop/nginx/blog/one;
	}	

		server {
		server_name 127.0.0.1;
		listen 83;
		root /home/sss/Desktop/nginx/blog/two;
	}

		server {
		server_name 127.0.0.1;
		listen 84;
		root /home/sss/Desktop/nginx/blog/three;
	}
	
}

------------------------------------------------------------
d2 r1 r3
section_09

limit
bursty trafic
leaky backet

Module ngx_http_limit_conn_module

Syntax:	limit_conn zone number;
Default:	â€”
Context:	http, server, location
Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† ØªØ¹Ø¯Ø§Ø¯ Ø§ØªØµØ§Ù„Ø§Øª Ù‡Ù…Ø²Ù…Ø§Ù† (concurrent connections) Ø¨Ù‡ ÛŒÚ© Ù…Ù‚Ø¯Ø§Ø± Ù…Ø´Ø®Øµ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ø§ÛŒÙ† Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø¨Ù‡ Ú©Ø§Ù‡Ø´ Ø¨Ø§Ø± Ø±ÙˆÛŒ Ø³Ø±ÙˆØ± Ùˆ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø­Ù…Ù„Ø§Øª ÛŒØ§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¨ÛŒØ´ Ø§Ø² Ø­Ø¯ Ú©Ù…Ú© Ú©Ù†Ø¯.

sample code:
-----------------
user sss;
events {}
http {
	limit_conn_zone $binary_remote_addr zone=addr:2m;	
	limit_conn_status 429;

	server {
		server_name 127.0.0.1;
		listen 82;
		root /home/sss/Desktop/nginx/blog/one;
		limit_conn addr 1;
	}	
}
-----------------

Module ngx_http_limit_req_module

Syntax:	limit_req zone=name [burst=number] [nodelay | delay=number];
Default:	â€”
Context:	http, server, location
Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ù†Ø±Ø® Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§ (rate limiting) Ø§Ø² Ø·Ø±Ù Ú©Ù„Ø§ÛŒÙ†Øªâ€ŒÙ‡Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ ØªØ§ Ø¬Ù„ÙˆÛŒ Ø§Ø±Ø³Ø§Ù„ Ø¨ÛŒØ´ Ø§Ø² Ø­Ø¯ Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§ (Ù…Ø«Ù„Ø§Ù‹ Ø­Ù…Ù„Ø§Øª DDoS ÛŒØ§ Ø±Ø¨Ø§Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø²Ø§Ø­Ù…) Ú¯Ø±ÙØªÙ‡ Ø´ÙˆØ¯.

sample code:
-----------------
user sss;
events {}
http {
	limit_req_zone $binary_remote_addr zone=addr:2m rate=3r/s;
	limit_conn_status 429;

	server {
		server_name 127.0.0.1;
		listen 82;
		root /home/sss/Desktop/nginx/blog/one;
		limit_req zone=addr burst=5;
		location / {}
	}	
}
-----------------

Syntax:	limit_rate_after size;
Default:	limit_rate_after 0;
Context:	http, server, location, if in location
This directive appeared in version 0.8.0.
 Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ø³Ø±Ø¹Øª Ø§Ù†ØªÙ‚Ø§Ù„ Ø¯Ø§Ø¯Ù‡ (bandwidth throttling) Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ØŒ ÙˆÙ„ÛŒ ÙÙ‚Ø· Ø¨Ø¹Ø¯ Ø§Ø² Ø§Ø±Ø³Ø§Ù„ Ù…Ù‚Ø¯Ø§Ø± Ù…Ø´Ø®ØµÛŒ Ø§Ø² Ø¯Ø§Ø¯Ù‡

Syntax:	limit_rate rate;
Default:	limit_rate 0;
Context:	http, server, location, if in location
The rate is specified in bytes per second.
 Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ø³Ø±Ø¹Øª Ø§Ù†ØªÙ‚Ø§Ù„ Ø¯Ø§Ø¯Ù‡ (bandwidth throttling) Ø¨Ù‡ Ú©Ù„Ø§ÛŒÙ†Øª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯

sample code:
-----------------
user sss;
events {}
http {

	server {
		server_name 127.0.0.1;
		listen 82;
		root /home/sss/Desktop/nginx/blog/one;
		limit_rate_after 10m;
		limit_rate 1m;
		location / {}
	}	
}
------------------------------------------------------------
d2 r1 r2
section_10

Module ngx_http_auth_basic_module

Syntax:	auth_basic string | off;
Default:	auth_basic off;
Context:	http, server, location, limit_except
Ø¨Ø±Ø§ÛŒ ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ø³Ø§Ø¯Ù‡ HTTP (Basic Authentication) Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ø§ÛŒÙ† Ø±ÙˆØ´ Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ÛŒÚ© Ù¾Ù†Ø¬Ø±Ù‡ Ù„Ø§Ú¯ÛŒÙ† (Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ùˆ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±) Ù†Ù…Ø§ÛŒØ´ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ ØªØ§ Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ ÛŒÚ© Ù…Ø³ÛŒØ± Ø®Ø§ØµØŒ Ù‡ÙˆÛŒØª Ø®ÙˆØ¯ Ø±Ø§ ØªØ§ÛŒÛŒØ¯ Ú©Ù†Ù†Ø¯.

Syntax:	auth_basic_user_file file;
Default:	â€”
Context:	http, server, location, limit_except

use hash for password in file
sample hash in terminal: openssl passwd sss
user:password in file

sample code:
-----------------
user sss;
events {}
http {

	server {
		server_name 127.0.0.1;
		listen 82;
		root /home/sss/Desktop/nginx/blog/one;
		auth_basic "home";
		auth_basic_user_file /etc/nginx/conf.d/passwd;
		location / {}
	}	
}

------------------------------------------------------------
d2 r1 r2
section_11

ngx_http_access_module
allow 
deny

Syntax:	allow address | CIDR | unix: | all;
Default:	â€”
Context:	http, server, location, limit_except

Syntax:	deny address | CIDR | unix: | all;
Default:	â€”
Context:	http, server, location, limit_except

------------------------------------------------------------
d3 r1
section_12

proxy_cache
proxy_cache_valid
stale

Syntax:	proxy_cache_path path [levels=levels] [use_temp_path=on|off] keys_zone=name:size [inactive=time] [max_size=size] [min_free=size]
 		[manager_files=number] [manager_sleep=time] [manager_threshold=time] [loader_files=number] [loader_sleep=time] 
		[loader_threshold=time] [purger=on|off] [purger_files=number] [purger_sleep=time] [purger_threshold=time];
Default:	â€”
Context:	http
Ø¨Ø±Ø§ÛŒ ØªØ¹Ø±ÛŒÙ Ù…Ø­Ù„ Ùˆ Ù…Ø´Ø®ØµØ§Øª Ø­Ø§ÙØ¸Ù‡ Ú©Ø´ (cache) Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ø§ÛŒÙ† Ø¯Ø³ØªÙˆØ± Ø¯Ø± Ø¨Ù„Ø§Ú© http Ù†ÙˆØ´ØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ùˆ Ù…Ø´Ø®Øµ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ Ú©Ù‡:
ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ú©Ø´ Ú©Ø¬Ø§ Ø°Ø®ÛŒØ±Ù‡ Ø´ÙˆÙ†Ø¯ØŒ
Ú†Ù‡ Ø³Ø§Ø®ØªØ§Ø±ÛŒ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ù†Ø¯ØŒ
Ú†Ù‡ Ø¸Ø±ÙÛŒØªÛŒ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ù†Ø¯ØŒ
Ùˆ Ú†Ù‡ Ø³ÛŒØ§Ø³Øªâ€ŒÙ‡Ø§ÛŒÛŒ Ø¨Ø±Ø§ÛŒ Ø­Ø°Ù Ùˆ Ø§Ù†Ù‚Ø¶Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´ÙˆØ¯.

Syntax:	proxy_cache zone | off;
Default:	proxy_cache off;
Context:	http, server, location

Syntax:	proxy_cache_valid [code ...] time;
Default:	â€”
Context:	http, server, location
Sets caching time for different response codes
proxy_cache_valid 200 302 10m;
proxy_cache_valid 404 1m;
Ø¨Ø±Ø§ÛŒ ØªØ¹ÛŒÛŒÙ† Ù…Ø¯Øª Ø²Ù…Ø§Ù† Ø§Ø¹ØªØ¨Ø§Ø± Ú©Ø´ Ù¾Ø§Ø³Ø®â€ŒÙ‡Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØªâ€ŒØ´Ø¯Ù‡ Ø§Ø² Ø³Ø±ÙˆØ± upstream Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.

$upstream_cache_status
keeps the status of accessing a response cache (0.8.3). The status can be either â€œMISSâ€, â€œBYPASSâ€, â€œEXPIREDâ€, â€œSTALEâ€, â€œUPDATINGâ€, â€œREVALIDATEDâ€, or â€œHITâ€.

Syntax:	proxy_cache_key string;
Default:	proxy_cache_key $scheme$proxy_host$request_uri;
Context:	http, server, location

proxy_cache_key "$host$request_uri $cookie_user";

Syntax:	proxy_cache_bypass string ...;
Default:	â€”
Context:	http, server, location
Ù…ÛŒâ€ŒØªÙˆÙ†Ù‡ ÛŒÚ© ÛŒØ§ Ú†Ù†Ø¯ Ù…ØªØºÛŒØ± (Ù…Ø«Ù„ $cookie_..., $arg_..., $http_...) ÛŒØ§ Ù…Ù‚Ø§Ø¯ÛŒØ± Ø«Ø§Ø¨Øª Ø¨Ø§Ø´Ù‡.
Ø§Ú¯Ø± Ø­ØªÛŒ ÛŒÚ©ÛŒ Ø§Ø² Ø§ÛŒÙ† Ù…ØªØºÛŒØ±Ù‡Ø§ Ù…Ù‚Ø¯Ø§Ø± ØºÛŒØ±Ø®Ø§Ù„ÛŒ ÛŒØ§ Ù…ØªÙØ§ÙˆØª Ø§Ø² "0" Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ù‡ØŒ Ú©Ø´ Ù†Ø§Ø¯ÛŒØ¯Ù‡ Ú¯Ø±ÙØªÙ‡ Ù…ÛŒâ€ŒØ´Ù‡.

proxy_cache_bypass $http_cache_bypass; => header -> cache_bypass=<number or string and not 0 or empty>
proxy_cache_bypass $arg_shold_bypass_cache; -> in url ?shold_bypass_cache=True
proxy_cache_bypass $cookie_nocache;

Syntax:	proxy_cache_use_stale error | timeout | invalid_header | updating | http_500 | http_502 | http_503 | http_504 | http_403 | http_404 | http_429 | off ...;
Default:	proxy_cache_use_stale off;
Context:	http, server, location
Ø¢ÛŒØ§ Ø¯Ø± ØµÙˆØ±Øª ÙˆÙ‚ÙˆØ¹ Ø®Ø·Ø§ØŒ Ø§Ø² Ù†Ø³Ø®Ù‡ Ú©Ø´â€ŒØ´Ø¯Ù‡ (stale) Ù¾Ø§Ø³Ø® Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´ÙˆØ¯ ÛŒØ§ Ù†Ù‡.

Syntax:	proxy_connect_timeout time;
Default:	proxy_connect_timeout 60s;
Context:	http, server, location
 Ù…Ø¯Øªâ€ŒØ²Ù…Ø§Ù†ÛŒ Ø±Ø§ Ù…Ø´Ø®Øµ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ Ú©Ù‡ Nginx Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ù‚Ø±Ø§Ø±ÛŒ Ø§ØªØµØ§Ù„ Ø§ÙˆÙ„ÛŒÙ‡ Ø¨Ø§ Ø³Ø±ÙˆØ± upstream (Ù…Ø«Ù„Ø§Ù‹ backend ÛŒØ§ API) ØµØ¨Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯.

Syntax:	proxy_cache_lock on | off;
Default:	proxy_cache_lock off;
Context:	http, server, location
This directive appeared in version 1.1.12.
only one request when multi request
 Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² "cache stampede" Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ø§ÛŒÙ† Ø­Ø§Ù„Øª Ø²Ù…Ø§Ù†ÛŒ Ø±Ø® Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ Ú©Ù‡ Ú†Ù†Ø¯ÛŒÙ† Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù‡Ù…Ø²Ù…Ø§Ù† Ø¨Ø±Ø§ÛŒ ÛŒÚ© Ù…Ù†Ø¨Ø¹ Ú©Ø´â€ŒÙ†Ø´Ø¯Ù‡ Ø¨Ù‡ Ø³Ø±ÙˆØ± upstream ÙØ±Ø³ØªØ§Ø¯Ù‡ Ø´ÙˆÙ†Ø¯.
 Ø§Ú¯Ø± ÛŒÚ© URL Ø¨Ø±Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ† Ø¨Ø§Ø± Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø´ÙˆØ¯ Ùˆ Ù‡Ù†ÙˆØ² Ú©Ø´ Ù†Ø´Ø¯Ù‡ Ø¨Ø§Ø´Ø¯ØŒ ØªÙ…Ø§Ù… Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§ÛŒ Ù‡Ù…Ø²Ù…Ø§Ù† Ø¨Ù‡ Ø³Ø±ÙˆØ± upstream ÙØ±Ø³ØªØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯. Ø§ÛŒÙ† ÙØ´Ø§Ø± Ø²ÛŒØ§Ø¯ÛŒ Ø¨Ù‡ backend ÙˆØ§Ø±Ø¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.


sample code:
-----------------
# main context
user sss;
events {}
http {

	proxy_cache_path /home/sss/Desktop/cache levels=1:2 keys_zone=mycache:10m inactive=3h max_size=20g;

	upstream backends {
		server 127.0.0.1:82;
		server 127.0.0.1:83;
		server 127.0.0.1:84;
	}


	server {
		server_name 127.0.0.1;
		listen 81;
		location / {
			proxy_pass http://backends;
			proxy_cache mycache;
			proxy_cache_valid any 10m;
			proxy_cache_key "$host$request_uri $cookie_user";
			proxy_cache_bypass $http_cache_bypass;
			proxy_cache_use_stale error timeout http_500 http_503;
			proxy_connect_timeout 30s;
			proxy_cache_lock on ;
			add_header X-Proxy_Cache $upstream_cache_status;
		}
	}	

	server {
		server_name 127.0.0.1;
		listen 82;
		root /home/sss/Desktop/nginx/blog/one;
	}	

		server {
		server_name 127.0.0.1;
		listen 83;
		root /home/sss/Desktop/nginx/blog/two;
	}

		server {
		server_name 127.0.0.1;
		listen 84;
		root /home/sss/Desktop/nginx/blog/three;
	}
	
}



------------------------------------------------------------
d3 r1
section_13

buffering

Syntax:	proxy_buffering on | off;
Default:	proxy_buffering on;
Context:	http, server, location
Ù…Ø´Ø®Øµ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ Ú©Ù‡ Ø¢ÛŒØ§ Ù¾Ø§Ø³Ø® Ø¯Ø±ÛŒØ§ÙØªÛŒ Ø§Ø² Ø³Ø±ÙˆØ± upstream Ø§Ø¨ØªØ¯Ø§ Ø¯Ø± Ø­Ø§ÙØ¸Ù‡ (buffer) Ø°Ø®ÛŒØ±Ù‡ Ø´ÙˆØ¯ ÛŒØ§ Ù…Ø³ØªÙ‚ÛŒÙ…Ø§Ù‹ Ø¨Ù‡ Ú©Ù„Ø§ÛŒÙ†Øª Ø§Ø±Ø³Ø§Ù„ Ø´ÙˆØ¯.

------------------------------------------------------------
d3 r1
section_14

gzip
compresses responses
brotli

Syntax:	gzip on | off;
Default:	gzip off;
Context:	http, server, location, if in location


Syntax:	gzip_comp_level level;
Default:	gzip_comp_level 1;
Context:	http, server, location
Sets a gzip compression level of a response. Acceptable values are in the range from 1 to 9.

Syntax:	gzip_min_length length(byte);
Default:	gzip_min_length 20;
Context:	http, server, location
ØªØ¹ÛŒÛŒÙ† Ù…ÛŒâ€ŒÚ©Ù†Ù‡ Ø­Ø¯Ø§Ù‚Ù„ Ø§Ù†Ø¯Ø§Ø²Ù‡ Ù¾Ø§Ø³Ø® (Ø¨Ø± Ø­Ø³Ø¨ Ø¨Ø§ÛŒØª) Ú©Ù‡ Nginx Ø¨Ø§ÛŒØ¯ ÙØ´Ø±Ø¯Ù‡â€ŒØ§Ø´ Ú©Ù†Ù‡.

Syntax:	gzip_disable regex ...;
Default:	â€”
Context:	http, server, location
This directive appeared in version 0.6.23.
Ø¯Ø³ØªÙˆØ± gzip_disable Ø¨Ù‡ Nginx Ù…ÛŒâ€ŒÚ¯Ù‡ Ú©Ù‡ Ø¨Ø±Ø§ÛŒ Ø¨Ø¹Ø¶ÛŒ Ø§Ø² Ú©Ø§Ø±Ø¨Ø±Ù‡Ø§ gzip Ø±Ùˆ ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ù†Ù‡. Ù…Ø¹Ù…ÙˆÙ„Ø§Ù‹ Ø¨Ø±Ø§ÛŒ Ù…Ø±ÙˆØ±Ú¯Ø±Ù‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ ÛŒØ§ Ù†Ø§Ø³Ø§Ø²Ú¯Ø§Ø± Ø¨Ø§ gzip Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´Ù‡ØŒ Ù…Ø«Ù„ Internet Explorer 6 Ùˆ Ù¾Ø§ÛŒÛŒÙ†â€ŒØªØ±.


Syntax:	gzip_types mime-type ...;
Default:	gzip_types text/html;
Context:	http, server, location
Ø§ÛŒÙ† Ø¯Ø³ØªÙˆØ± Ù…Ø´Ø®Øµ Ù…ÛŒâ€ŒÚ©Ù†Ù‡ Ú©Ø¯Ø§Ù… Ù†ÙˆØ¹ Ù…Ø­ØªÙˆØ§ (MIME types) Ø¨Ø§ÛŒØ¯ ØªÙˆØ³Ø· Nginx Ø¨Ø§ gzip ÙØ´Ø±Ø¯Ù‡ Ø¨Ø´Ù‡.

sample code:
-----------------
# main context
user sss;
events {}
http {
		gzip on;
		gzip_min_length 100;
		gzip_comp_level 4;
		gzip_disable "msie6";
		gzip_types text/plain text/css text/javascript;
		
		upstream backends {
			server 127.0.0.1:82;
		}
		server {
			server_name 127.0.0.1;
			listen 81;
			location / {
				proxy_pass http://backends;

			}
		}	

		server {
			server_name 127.0.0.1;
			listen 82;
			root /home/sss/Desktop/nginx/blog/one;
		}	
	
}


------------------------------------------------------------
d3 r1
section_15

Syntax:	keepalive_min_timeout timeout;
Default:	keepalive_min_timeout 0;
Context:	http, server, location
This directive appeared in version 1.27.4.
Ø¨Ø±Ø§ÛŒ Ù†Ú¯Ù‡ Ø¯Ø§Ø´ØªÙ† Ø§ØªØµØ§Ù„ Ø¨ÛŒÙ† Nginx Ùˆ Ú©Ù„Ø§ÛŒÙ†Øª ÛŒØ§ Ø¨Ú©â€ŒØ§Ù†Ø¯ (Ù…Ø«Ù„ upstream servers) Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒØ¯.

Syntax:	keepalive_requests number;
Default:	keepalive_requests 1000;
Context:	http, server, location
This directive appeared in version 0.8.0.
Ú†Ù†Ø¯ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù…ÛŒâ€ŒØªÙˆÙ†Ù† Ø¨Ù‡ ØµÙˆØ±Øª Ù¾Ø´Øªâ€ŒØ³Ø±â€ŒÙ‡Ù… Ø§Ø±Ø³Ø§Ù„ Ø¨Ø´Ù† Ù‚Ø¨Ù„ Ø§Ø² Ø§ÛŒÙ†Ú©Ù‡ Ø§ØªØµØ§Ù„ Ø¨Ø³ØªÙ‡ Ø¨Ø´Ù‡.

Syntax:	keepalive_disable none | browser ...;
Default:	
keepalive_disable msie6;
Context:	http, server, location
ØªØ¹ÛŒÛŒÙ† Ù…ÛŒâ€ŒÚ©Ù†Ø¯ Ú©Ù‡ Ø¨Ø±Ø§ÛŒ Ú©Ø¯Ø§Ù… Ù…Ø±ÙˆØ±Ú¯Ø±Ù‡Ø§ Ù‚Ø§Ø¨Ù„ÛŒØª Keep-Alive ØºÛŒØ±ÙØ¹Ø§Ù„ Ø´ÙˆØ¯

Syntax:	send_timeout time;
Default:	send_timeout 60s;
Context:	http, server, location
Ø§Ú¯Ø± Ú©Ù„Ø§ÛŒÙ†Øª Ø¨Ø±Ø§ÛŒ Ù…Ø¯ØªÛŒ Ù‡ÛŒÚ† Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ø§Ø² Ø³Ø±ÙˆØ± Ø¯Ø±ÛŒØ§ÙØª Ù†Ú©Ù†Ù‡ØŒ Ø§Ø±ØªØ¨Ø§Ø· Ù‚Ø·Ø¹ Ø¨Ø´Ù‡ 
Ø¨ÛŒØ´ØªØ± Ø¯Ø± Ø²Ù…Ø§Ù† Ù†ÙˆØ´ØªÙ†(whrite)

Syntax:	client_body_timeout time;
Default:	client_body_timeout 60s;
Context:	http, server, location
between two successive read 
 Ø³Ø±ÙˆØ± Ú†Ù‚Ø¯Ø± Ù…Ù†ØªØ¸Ø± Ø¨Ù…Ø§Ù†Ø¯ ØªØ§ Ú©Ù„ Ø¨Ø§Ø¯ÛŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ú©Ù„Ø§ÛŒÙ†Øª Ø¯Ø±ÛŒØ§ÙØª Ø´ÙˆØ¯.

sample code:
-----------------
# main context
user sss;
events {}
http {
		keepalive_min_timeout 20s 18s;
		keepalive_requests 20;
		keepalive_disable msie6;
		send_timeout 60s;
		client_body_timeout 30s;

		upstream backends {
			server 127.0.0.1:82;
		}
		server {
			server_name 127.0.0.1;
			listen 81;
			location / {
				proxy_pass http://backends;

			}
		}	

		server {
			server_name 127.0.0.1;
			listen 82;
			root /home/sss/Desktop/nginx/blog/one;
		}	
	
}

------------------------------------------------------------
d3 r1
section_16

rewrite

if (condition){ operations }

Syntax:	return code [text];
		return code URL;
		return URL;
Default:	â€”
Context:	server, location, if

Syntax:	rewrite regex replacement [flag];
Default:	â€”
Context:	server, location, if
flags= last, break
301, 302
 Ø§Ø² Ø¢Ù† Ø¨Ø±Ø§ÛŒ Ø±ÛŒØ¯Ø§ÛŒØ±Ú©Øª Ú©Ø±Ø¯Ù† Ù…Ø³ÛŒØ±Ù‡Ø§ØŒ Ø­Ø°Ù Ù¾Ø³ÙˆÙ†Ø¯Ù‡Ø§ØŒ ÛŒØ§ Ù‡Ø¯Ø§ÛŒØª Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¨Ù‡ Ù…Ø³ÛŒØ± Ø¬Ø¯ÛŒØ¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.

Syntax:	rewrite_log on | off;
Default:	rewrite_log off;
Context:	http, server, location, if
notice level

sample code:
-----------------
# main context
user sss;
events {}
http {
		server {
			server_name 127.0.0.1;
			listen 81;
			return 301 $scheme://www.domain.com$request_uri
			root /home/sss/Desktop/nginx/blog/one;

			# rewrite ^/first$ /two;

			# location / {
			# 		# if ($request_method = POST){
			# 		# 	return 405 "method is not allowed";
			# 		# }
			# 		# return 200 "Hello";
			# 		# return 302 http://www.google.com;
			# 		# return 301 /two;
			# 		# rewrite ^/first$ /two;
			# 		# rewrite ^/first$/(.*)$/(.*)$/ /two/$1/$2;
			# }

			location /first {
					rewrite ^/first$/(.*)$ /blog/$1;
			}
			
			location /two {
				root /home/sss/Desktop/nginx/blog;
			}
			
			location /blog {
				root /home/sss/Desktop/nginx;
			}
		}	
	
}

------------------------------------------------------------
d3 r1
section_17

worker_connections
 Ù‡Ø± worker process Ø­Ø¯Ø§Ú©Ø«Ø± Ú†Ù†Ø¯ Ø§ØªØµØ§Ù„ (connection) Ù‡Ù…â€ŒØ²Ù…Ø§Ù† Ù…ÛŒâ€ŒØªÙˆÙ†Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù†Ù‡.
in terminl: ulimit -n

accept_mutext on/off;

Ù…Ø´Ø®Øµ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ Ú©Ù‡ worker processÙ‡Ø§ Ú†Ú¯ÙˆÙ†Ù‡ Ø¨Ù‡ Ø§ØªØµØ§Ù„Ø§Øª Ø¬Ø¯ÛŒØ¯ (new connections) Ù¾Ø§Ø³Ø® Ø¨Ø¯Ù‡Ù†Ø¯.

daemon on/off;
 Ø¢ÛŒØ§ Nginx Ø¨Ù‡â€ŒØµÙˆØ±Øª Ø¯Ø§ÛŒÙ…ÙˆÙ† (Background Process) Ø§Ø¬Ø±Ø§ Ø´ÙˆØ¯ ÛŒØ§ Ù†Ù‡.



worker_rlimit_nofile number;
 Ø¨Ø±Ø§ÛŒ ØªØ¹ÛŒÛŒÙ† Ø­Ø¯Ø§Ú©Ø«Ø± ØªØ¹Ø¯Ø§Ø¯ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒÛŒ Ø§Ø³Øª Ú©Ù‡ Ù‡Ø± ÙØ±Ø¢ÛŒÙ†Ø¯ worker Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø¨Ø§Ø² Ú©Ù†Ø¯.

Syntax:	limit_except method ... { ... }
Default:	â€”
Context:	location
Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ù†ÙˆØ¹â€ŒÙ‡Ø§ÛŒ Ø®Ø§ØµÛŒ Ø§Ø² Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§ÛŒ HTTP (Ù…Ø«Ù„ POST, PUT, DELETE, ...) Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯

sample code 
-----------------
# main context
user sss;
events {}
http {
		server {
			server_name 127.0.0.1;
			listen 81;
			root /home/sss/Desktop/nginx/blog/one;

			location / {
					limit_except POST {
					deny  all;
}
			}
		}	
}
